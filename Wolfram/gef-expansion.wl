(* GEF stands for GreedyEgyptianFraction *)

FirstStringDifference[s1_String, s2_String] := Module[{i, n},
    n = Min[StringLength@ s1, StringLength@ s2];

    (* `Return` does not work inside of `Do` loops. *)
    For [ i = 1, i <= n, i++,
        If [ StringPart[s1, i] != StringPart[s2, i],
            Return@ i;
        ];
    ];

    If [ StringLength@ s1 == StringLength@ s2, -1, n + 1 ]
]

FirstDecimalDifference[a_?NumberQ, b_?NumberQ] := Module[{s1, s2, i, n},
    FirstStringDifference[
        StringReplace[ToString[a], "." -> ""],
        StringReplace[ToString[b], "." -> ""]
    ]
]

GEFExpansionNextTerm[
    y -> yOption_,
    $Precision -> Automatic,
    terms -> termsOption_
] := GEFExpansionNextTerm[
    y -> yOption,
    $Precision -> 2 (1 + IntegerLength@ Last@ termsOption),
    terms -> termsOption
]

GEFExpansionNextTerm[
    y -> yOption_?NumericQ /; Positive[yOption],
    $Precision -> $Precision_Integer?Positive, (* should be a bit more than double the previous *)
    terms -> termsOption : {___Integer?Positive}
] := Module[{
    n = 0,
    p = 0,
    y = SetPrecision[yOption, $Precision],
    terms = termsOption,
    GetApprox,
    list,
    digit
},
    GetApprox[x_?NumberQ] := baseValue + 1 / SetPrecision[x 10^p, $Precision];

    Print["Computing Sum of Known Terms:"];
    baseValue = Total[1 / SetPrecision[#, $Precision] & /@ terms];
    Print["\tdone"];

    Print["Finding Correct Power of 10:"];

        While [ True,
            If [ GetApprox[9] <= y,
                Break[];
            ];
            p++;
        ];

        Print["\tp == ", p];
        Print["\tdone"];

    Print["Finding Correct Digits:"];
    If [ n == 0,
        list = Table[GetApprox[n + i] > y, {i, 1, 9}] ~Append~ False;
        digit = FirstPosition[list, False][[1]] - 1;
        n = digit;

        If [ n == 0 && p > 0, (* 9 10^(p-1) < x < 10^p *) (* maybe this should be && p > 1? *)
            p -= 2; (* -1 to get to the right value, -1 for the second digit *)
            n = 99;
        ];

        Print["\t", n, "*^", p];
    ];

    While [ p > 0,
        n *= 10;
        p--;
        list = Table[GetApprox[n + i] > y, {i, 0, 9}] ~Append~ False;
        digit = FirstPosition[list, False][[1]] - 2;

        n += digit;

        If [ p ~Mod~ 10 == 0,
            Print["n *^ ", p]
            (* Print["\t", n, "*^", p]; *)
        ];
    ];

    Print["\tdone"];

    n++;

    (* `difference - 1` because there is usually a decimal point. *)
    With[{ digits = FirstDecimalDifference[GetApprox@ n, y] - 1 },
        Print[];
        Print["n = ", n];
        Print[digits, " digits of accuracy"];
        Return@ {n, digits};
        (* Return[n]; *)
    ];
]

GEFExpansionNextTerm[y -> E, $Precision -> 100, terms -> {1, 1, 2, 5, 55}]

(* list = {1, 1, 2, 5, 55}; *)
(* Sum[IntegerLength[i], {i, list}] *)

(* Total[IntegerLength /@ list] *)
(* (* This at least works for Pi *)
IntegerLength[Subscript[term, n_Integer /; n > 0]] := Sum[
    IntegerLength[ Subscript[term, k] ],
    {k, n - 1}
] *)


GEFExpansionNextTerm[
    y -> Pi - 3,
    $Precision -> 18000, (* this is for the 14th number *)
    terms -> {
        (* these terms need to be put in manually *)
        (* d-prec == decimal precision *)
        (* +----+-------+------+ *)
        (* |indx| d-prec|length| *)
        (* +----+-------+------+ *)
        (* |  1 |     1 |    1 | *) 8,
        (* |  2 |     3 |    2 | *) 61,
        (* |  3 |     7 |    4 | *) 5020,
        (* |  4 |    17 |    9 | *) 128541455,
        (* |  5 |    34 |   18 | *) 162924332716605980,
        (* |  6 |    68 |   35 | *) 28783052231699298507846309644849796,
        (* |  7 |   137 |   69 | *) 871295615653899563300996782209332544845605756266650946342214549769447,
        (* |  8 |   275 |  138 | *) 910061501066771569929177518283776533536956708990096834567481804094469953756509557953741463718463021812584586928871816513428410989679108567,
        (* |  9 |   552 |  277 | *) 1519975995495123548864232057230913989322800465552709630913779900493650670821767027219702518074382949141691252249407810669110196772510918483421661269623000241540612237295778589839203838068946388167303612692018867252097220910799910121318313730089594877104929553610347363788990198,
        (* | 10 |  1108 |  553 | *) 3615455471582486000145649018223397099166826163683301789062540270509414959783556780836761642204519869354884239583194801387002048797969779091794868463185702594818005541857630128575946136035053165329955953027655941749295936491729557558509795623239994105636752198836270784061141719941852449881772325462303572255174255057672638567474967542491354471381176431978776054756233942285930200578166190648569473860832228026892389517758910739072052112180302512759973884762505528749693481612414819148862238401215750025609802645249507759302626955226055882048423169423343,
        (* | 11 |  2217 | 1109 | *) 44307489566534943680673245462504159770281187977643191015419371812634393000467171774383804593891321909064706907093777137161291151633698755098127790260131130447691904647429154709335414247960087137917104875600833337266623752183654599354324990490308332562223348390184611948219514918579489845234698365013397796478714854840642562972820230436312709375435435083574445573053724718588356666401116940513751151217306043649172632623786705270622659362235034562392258756013762402728647299194328632265606494795066906374034167576732264734123090031919070861358419549096834837454639370074304352060364101073076810631784982842723519925131360164706882689225079787446349554004080546731917789072805592046813543159135378307431306080876183415707726907097068958880259114829000271986605457522146630666278182645118473157779897822499164640972052019121154750598694064423247029865182042839418188632791961668626330412746830682144727497777944644616148776909032232648850690189590719183725223256749757437828732837682409265622910158923833325966358322458568736250159945534072134155301696017487287118261706993556548894936260406435592564464187488350,
        (* | 12 |  4438 | 2218 | *) 4367953236304177614190587090632605810582145948988604283642679589949526430347920830575085735420499485563741172858787864117559257618398463948391852107638413257285314116802502271585687535167978582358094765491727244580073091118890550484579423105860537546037483061718236660747620025755811157455826705006738833089488012273502342396962742192972059054147688390000792466147727784807844249515079730071805278405940726682359965642463776501681586703849377021345184716825458957841226986324309445986797677067408879247283235185541107949200602646956907493700108243425184370619508526202183710600603437919004396432139111987130829970865538316640465538995113439674256563705319807216408768264984805289585476782328644447993481091679251838344089515093466887137974811654387885784031612136704680376307813851749440433461169608360908522148256805912161126193099365067180196568125073354240205191839048078885148252326182079162697697796803574838898288453500424001661081391315124673184888792441059103474126250173801944166215016024937759021726502611627955005753827281954663481889983262632177271763972615514851131258404241451394881500490028038381163955241365577765817528192590728325200289650450277079342173239285129271778181331063430790363530755579541899027043256146353345841987111726152699431987243864037145485842076984277841641415664013221673720868708125520954667202380945617338767017236132892903202401012054226057501173915809587767496429354856736622051638588369969315189093811903189050278635491765321994732977139736331410121674927835574501516440335402475082161040440524648319495060259942319472676005796203252771637981834695514422047618968690686219727381163156954314555864628367953271500859086690430743194667122221813925017676648116160463263983032494237074607035328905903920114035490272584294775772153717780738706334441018068117396823791255276386410633471277541764575186785182639503782938134841503617220222442123063195981779012224255102596735458899499729505981225414304127116477971768309516772534671165404656900324587898911705631126217530260571047205168980244724741159587723924353157779229895236378288859046711737047998541778525619234824528543032208666398750292124781847458537653610881440242387138133944144917779365871276292867235683860840947998282964,
        (* | 13 |  8873 | 4436 | *) 88900561245556561349452773147372348984738264805625718520355056903153749536092116563257745274036128127716407706313609137228241694677622480468474296095314011407884951455245067334224272147893560355226611237681533397334393231861969102994056228548607316043624103727065658987551160718049873264543651242803196335655375617675432493962663007505715827144006868441265360202519235204455544717118991360826411989498293476565094107078114379741725298933424815477258390624256567272010105788663052220513854613144009067578415626535508321267339076678802374946706316721687140261410126710633824688595418211637887536125804159560811803200220733330268091719869844503462961459013900015286447666782433411832595380627341693676063413137099017784082072614887788852942583112795088720438488033816521725976288876175264532965383104573785318325188586027397957202631965709997808390610397435809087271922800377040686651552355034248643047741049339391374091827532943531088345721099113983672142623756368167764786202254316092533825904400772120948692463091255655861222139474392782928492877591359688772914184171430530269548661781511534047442878472372584903316960036621241174083765936786149142273355635493771076062161196385294766499276191679823866573627975276486211139733067672893123980040698673832350719538219851974840030384201671150985645191842744756658867163113328441480559089877402788452591239430265602170873124756523407647645950160109824391335901643532931880627253101151672652842789808107032563193875964399649883008571785223783258070743670098482034708498397611893377509172784854218314517703813944165352409770070385352764797276048197032148233863367709948527510995293715669580983336009704336803980207195013483957082908486037527179141474678955166171272036829251018561909632795958286184005631723037428271681013235408261115000622106023595696892535029850814882771479026624511309398320301199632099372767893611213078990377109060550087694679330505068929668903976016191346671136427161241530379743527757597229897870342499179205198141287937858804416908082459363999786886806412855609107223710845007572155521145199923011678915522393480322068884620712893395882057814037985194270283225301856727942717602213284828600168089207912151270172298702140409595412401265748074721720566838663237590903335296120014351953384397672617148158465275401902527446335864925684696968387314969545055999763155746878468458313212586187629329141309811856153954833660714284040507292194968051627883871231195475460872063781787882162979500577556187076093009721076430380791399041146914045340200237127724393620574015788306007002854327755713022378733491066822743608068029802402512798404726236857730036077060976109056406044334709682208837639586477881586711975339428596303741271830599040567028384928187590899591621156566039649940749173768015189338143362682516793020721854791509418787559419911904744853604267264976482171607459533813309330295821898391501114310203699504253278233611197167044187436229889420529440022673672268061588026719633427171478166530386570519484023372898586699889418679562747545404264013575969461100769410136279380153209555065892930275543409316447341563080526176133192647190369678142869490106016416408709117543557861931499436347188042882721889732908924101477579356574400207650077458467790136961276302794151347392308443652205958440148776514524428931700633249859048146167776096534701422214956544582270019905782282269750868487379094376624744422371011554939235327484367114042600540574141685645921681586698366610134289185271563162146499641970122594224088315861101757223914905994072446676167869035673117645109250235685505634619604906905276562741372128960649394614982982321396492320554837001710164577789427449102409780955882201916033262009240435305563507403874202631453723207577238774178286566006531872310779246247026385144749917422040847972283669502932331292442154172371458727764961954419343548395214854192757509399958271452080456927285497503791678287823230539509834241899153785844003981532098540908296259745588064172603762305138859135320055375700749103367513277766512458492032910100815080395032928541432629529459216630129505970569098210734010153587730520268060439665819684488767874116603213132788127393716301703395288828199093454062325564400667548995952402153336964334798851951420015124335170865408065762166753431055249421169678647601369809441215913007238657395622826889346181232678336569042441699800390909310164395456482389497447672914369371901597325460852087133718051653988095743517264536826021268256508285345763,
        (* | 14 | 17745 | 8873 | *) 10149267502354012833070873414852755767519590836201967729285206353248486625248561660754783866216035763083738202250273651976136969908704779182065573993440527423107551310284956870393750729690151967575715072292795914924874082513209717783512134178359074071337141636103102540842305197590731702808354756276075174430306974672288516301583282409586263529446001010101717593037767537429181656181477242733453707243498200513502548625147949610720240077169137017976144034291477534426468429624785641993407374371510168895364699869344406368315843388060087180074448351414339897520069475579214461696695230646568398343940330698059911301713096033697679357439873653795534476846993291147541081200428835078282927876029004903328374978317254135109255229970119205381659800555973715681330912228260914920535985889020711365172660627128571221722419507343900693875966136072617818925685023118906815002850022087070924328108051390502353275343577169104539441477747064399128255885682367345881199681204606669110709490331496510333645199658463646989747793681264217075175285550808227097664553644236674655685601295305854145266860559589504179569414153461097714075348101344677600630723023079392460830707541052894480370076668714541759115103312780094404524433718122526245871505228774258650485620414455967692829368091589929060774673115225496385542381226947244341210807482923631228551546537805013854415956762704395871378649097820812952960778063401203831441587476552412204781046784157171833284889746956640675367462867811437512579543842966009796374667585591786390026894240200260697352312959226253200473297540726961557891995911054875556679553939914935423252570680534814952642824533853017344534891034909632676521169013945514578346382719396588187753609347657132930280764344366698986237926445838056255732992721439010977484026221323722181898190705208177157708418651995173771516827172430976288452566914935397123333217559534755124073367913869254079727789756266075849147971976135712229041470991108384608494194976155223796772985179513014736756060399373564461720854560551756050297520513316425424873466205207427767137017444398894698195226020197708114785555554529015561905518618152922562023264386127887692957634452477302828226965514394216673312845920705506642840467582208748122583331306426679098539140074592152397403435226335293765177769881569618858089721242287194190206719413176767452652010074416637204961741539757752197083394524654124608914585502682593299905668790541370563094917688950232215854699525260557063844630462091486792998803414835007166737652177467868911964851231493245129352385356119600584728650621536009296913170982451575916696649479874678166987788989055187865972383130523321483595598189075467240643337161328373682526953189371155518074035068753435485434263708971113552970538243925161416470373756333058858677441892221040451218986669085679039089846640405352566543836670889238701126792012293713688915407644740252436085918659921620336959328846838544936314697536343864215705636916671164736563512199402245941698475177734769790337537924310397216162359999211960782216755727016299051255376039546172847588709125242506731860230977736068420477743311220880290136212406596104563500489935955451764084393615380443130346342914861355387084299667560089560647200357194274948539133869324834262272790530842701256213519822875915403332457892264530950616345505073504187489916736870732010360489986268029389072190679397114792512040137370517210712909913301848157960428337217300917688806557024682235564882361843690574852858954613619629115839127248176161710183832692726811138537547713783305931555610394825493375213036702335181235707316643587604025274659873165588397962265424495762671892620806987703883524729194788989990072493487109757885112602148908328529640647768556074392908069191548027193904679649301316646364494864986810491392930853516184724533882230333632603892682938449934531859928205658939255377828420854518954496582654605412799009105696092236056736883514673314237938361302519900478784738481387732472909252394564506341451447976155399288602785191078974798803491460505039418108899422229280376299727432587781628844176806196636764196538926482835669663079579911983461954932475770109120647029566279104688498918051154368159855080191002108209955352149657322747425539411597667571418700719737911120943431594705974589543947874399914998610087444818177624110771719577557735936330833762988589909324093869274763204280219111079165868944244911279509205195093644495904925814459509356059846351148464509557011137059082685061121616321780238494055242307505493163629247000865734951970139030162174284485877342777941848459083246855495251324470095931150006861413942724706387940753787347515287358816552667826860054865609037547841369759368900850277836456872675266736415325738354700629665595110156241681813592203027810355781369071326446745068876800698260717014662335826878287695926201428451839162296082360066121251893237908928130996377357434617599668509772866590978966634750273239763458101848206813353011074515451719309765181755600830973609189603497099106585013624963308004630671301809213759757489601213536755958129959668266054207691066111174681196004917968234375386810490263177562943935113007608979166097756184241954454493854824853095054153208118535546920779458682897063792887108883173136883722803994517833741591548695456413708214575102192698567904863991644347649311128222121966409349785645987764002491563424775941703769787776814296232260006611852346923773764705186829080370021617441465769779606330197129437403340012629927548073242047125773212292268373854399865051619349833444470817497284377873158270585614687028432818730891760599389807064645768676070354479266441901491420756043574950872033608777377589563703037112266221276508047136804165492377062587197395911097226737947831749047583772025790526433355502977234041347782219480453252763561671542015997607955663027118290188784576093798674273984114281321058103770447415786564337213437363928709352535805457559357934863898055736836132845942200519369006109611763468883665947274170165017913406043624064913859696490586800315389078808497475236503519253454012143730854252657072670020862010492948837172346215774081555714461237488144589665487101597526585554721779880047919165960099668242501367589603880792638579671404305434050139889569396491672398915176125806052627147112742193941762853508997993818832296233307768855085081928033284334594024490124858585305228967651426297010905520903501928454828928144746778644835388285163258076142171812167439184464508712834865190823421727061366695383034260341646269420871349607415896251282210376101052373665233840757739143606660767929165665180872366698851560390948570672458374820103786499940930076687642770022048199976840708065608432035818238580442349192364070796139780678206923233128212404607807541285560263812648704174151066542882350584864705651856133743004760092374014253334088472640109317051692810173745512293204203639796583412174447256367118078424172833941688543038057775290781114559093376320868275801974647624913208668148590365404008221232292865694681815639088259561334632699758022117166256066296861319928222700957464136516448048742389729748257237495692395720607117857139066915549518063378483066632975114417318851362200207817714879908296270038220774944095080795530090173240765342772337920299982353181342143079229885171010350911293456393097439320810410905298757447555703725684889938828105253770587744803822936739012087217577826421702410949489484759091031259738894226117114652938133999182767302041365197158663779901883039944017563340449128235108246071073449459050849524374359438493902074139792828951417425538280738549124419110385280759403088425492462632277968049211573256071613737227384084332608194062926267336622761708715606189065730905310475227811526098333350858611686311823667131162125984667113412961743085933917424480166754646848925342707814710212954576683241253072737972797984111069634727782804696365223373256867658148278243334322119177469484074608572061916633640775035258307787913663790287366056181349838268711546363405547605468056717369844290409032766750849177874664859902446254479611779565524816342727506132695031559461250244867005506132026484727442136420382611872775235525677913021134181773612589422944080891342850533729457555813393747739551865420592965632021034503520325558791211934156226041132625573666235613428251020551788344313404099102967541642713001962365170151294742320435274148424558744725994419275709215176391088918173551688646922757989195903390889257773697774745049903830651362481277750058479462669823853405429903164429046738677188228915972023844748645073923300246878006623363582403797946571737603072515617537817106815306135244369062294911085743474955680246294809636251926420370400798664517203937292941680974829562527669198815602927301052726769050909572719406964454307628876976639096451668862019773718459151378928238338814325889696317585749949133997498677312850608763452577836993021709863284445948105941423891684668449468162124215243384519040043708372397573673332409931124244797271,
        (* +----+-------+------+ *)
        Nothing
    }
]
